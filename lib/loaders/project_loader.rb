class ProjectLoader
  def initialize(vuln_git_dir)
    @repo_path = vuln_git_dir
  end
  def load_data
    Dir["#{@repo_path}/projects/*.yml"].each do |file|
      yml = File.open(file) { |f| YAML.load(f) }
      Project.create!(
        name:                        yml['name'],
        fullname:                    yml['fullname'],
        subdomain:                   yml['subdomain'],
        project_url:                 yml['project_url'],
        description:                 yml['description'],
        git_commit_url_prefix:       yml['git_commit_url_prefix'],
        github_search_url_prefix:    yml['github_search_url_prefix'],
        github_edit_cve_url_prefix:  yml['github_edit_cve_url_prefix'],
        vulnerabilities_description: yml['vulnerabilities_description'],
        developers_description:      yml['developers_description'],
        logo:                        "#{yml['subdomain']}.png",
        bg_color:                    yml['bg_color'],
        fg_color:                    yml['fg_color'],
        curation_template:           yml['curation_template']
      )
    end
  end
end
