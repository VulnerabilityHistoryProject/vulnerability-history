class DEPSTagger

  def create_tags
    @DEPS_tag = Tag.create!(
      name: 'DEPS file changed',
      shortname: 'DEPS',
      color: '#dbe045',
      description: " The fix for this vulnerability involved changing the Chromium dependecy file"
    )
  end

  def apply_tags
    Vulnerability.joins(fixes: {commit: :filepaths}).where("filepaths.filepath = 'DEPS'").each do |v|
      VulnerabilityTag.create!(
        vulnerability: v,
        tag: @DEPS_tag
      )
    end
  end
end
