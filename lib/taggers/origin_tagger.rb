class OriginTagger

  def create_tags
    @Origin_tag = Tag.create!(
      name: 'Origin vulnerability',
      shortname: 'Origin',
      color: '#d845e0',
      description: "This vulnerability was introduced in the first few months of the project"
    )
  end

  def apply_tags
    tags = []
    vulns = Vulnerability.joins(vccs: :commit).where("commits.date_created < '2008-09-01'")
    vulns.each do |v|
      t = VulnerabilityTag.new(
        vulnerability: v,
        tag: @Origin_tag
      )
      tags << t
    end
    VulnerabilityTag.import tags
  end
end
