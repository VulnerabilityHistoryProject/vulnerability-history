class Writing

  def self.tag_article(slug)
    slug_file = "tmp/checkout/vhp-writing/tags/#{slug}.md"
    begin
      return File.read slug_file
    rescue
      $stderr.puts "WARNING: #{slug_file} not found"
      return ''
    end
  end

  def embed_details(str, model)
    new_str = str.gsub(':title:', model.title).
        gsub(':description:', model.description).
        gsub(':type:',        model.type).
        gsub(':commit_hash:', model.commit_hash).
        gsub(':date:',        model.date.rfc2822)

    new_str = new_str.split(/(:notes[~\w]*:)/).each do |note|
      notes_tag = note.scan(/~(\w+)/).flatten
      unless notes_tag.empty? || model.notes.empty?
        note.gsub!(/:notes[~\w]*:/, model.notes.dig(*notes_tag).to_s)
      end
    end
    return new_str.join
  end

end
