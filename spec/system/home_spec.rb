require "rails_helper"
require 'socket'

RSpec.describe "Home Test", :type => :system do
  before do
    @start = root_path
  end

  it "tests article presence" do

    visit @start
    gc = find '.grid-container'
    articles = gc.find(id: 'article-listing')
  end

  #   # verifies image
  #   article = articles.all('.vhp-articles')[1]
  #   blurb = article.all('.blurb')[2]
  #   wrapper = blurb.find('.grid-y')
  #   article_image = wrapper.find('.blurb-art')
  #   assert_equal 'vhp-art-rit', article_image.find('div')[:class]

  #   # verifies title
  #   header_and_text = wrapper.find('.blurb-text')
  #   article_title = header_and_text.find('h3')
  #   assert_equal 'Four and Some More', article_title.text
    
  #   # verifies blurb
  #   article_blurb = header_and_text.find('p')
  #   assert_equal 'Especially when the article count gets longer.', 
  #                 article_blurb.text.split(". ")[0...-1].join(". ") + "."       # ... is the exclusive index

  #   # verifies slug
  #   full_article_a = header_and_text.find('a')
  #   full_article_a_href = full_article_a[:href]
  #   assert_equal 'test-article-4', full_article_a_href.split("/")[-1]

  #   # verifies follows correct url
  #   full_article_a.click
  #   assert_equal full_article_a_href, current_url

  #   # verifies consistent article title
  #   gc = find '.grid-container'
  #   grid_x_title = gc.all('.grid-x')[0]
  #   cell_title = grid_x_title.find('.cell')
  #   title = cell_title.find('.centered-title')
  #   assert_equal 'Four and Some More', title.text

  #   # verifies author
  #   grid_x_author = gc.all('.grid-x')[1]
  #   cell_author = grid_x_author.find('.cell')
  #   byline = cell_author.find('.title-byline')
  #   assert_equal 'Bryce Murphy', byline.text

  #   # verifies consistent image
  #   grid_x_image = gc.all('.grid-x')[2]
  #   cell_image = grid_x_image.find('.cell')
  #   image = cell_image.find('div')
  #   assert_equal 'vhp-art-rit', image[:class]

  #   # verifies correct fulltext
  #   grid_x_fulltext = gc.all('.grid-x')[3]
  #   cell_fulltext = grid_x_fulltext.find('.cell')
  #   assert_equal(
  #     "Studies show, the more test articles you write, the harder it becomes to find " + 
  #     "new things to say, especially when nobody but the testers will see it.",
  #     cell_fulltext.text
  #   )

  #   # return home
  #   click_link 'The Vulnerability History Project'
  # end
end