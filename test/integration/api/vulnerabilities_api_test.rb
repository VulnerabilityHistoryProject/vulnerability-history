require "test_helper"
require 'json-schema'
require_relative 'vhp_api_test'

class VulnerabilitiesApiTest < VhpApiTest

  # NOTE! This is in the test environment, not the dev environment
  # You may need to update the fixture data to be more realistic
  test "/api/vulnerabilities fits the expected response schema" do
    get "/api/vulnerabilities"
    assert_response :success
    schema = openapi_yml.dig('paths','/api/vulnerabilities','get','responses',
                         '200','content','application/json','schema')
    JSON::Validator.validate! schema, @response.body, json: true
  end

end
