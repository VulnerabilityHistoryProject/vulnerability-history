require "cross_browser_test_case"

class VulnerabilitiesCrossBrowserTest < CrossBrowserTestCase

  test "vulnerability table filtering" do
    visit '/vulnerabilities'
    assert_text "upvotes"
    assert_text "allows remote attackers"
    assert_text "FooBar"
    find('label.table-nav-search').find('input').set('FooBar')
    assert_no_text "allows remote attackers"
    assert_text "FooBar"
  end

  test "vulnerability system filtering" do
    visit '/vulnerabilities'
    assert_text 'CVE-2011-3093'
    assert_text 'CVE-2016-1676'
    select 'CWE_119', from: 'tag_filters'
    assert_no_text 'CVE-2011-3093'
    assert_text 'CVE-2016-1676'
  end

end
