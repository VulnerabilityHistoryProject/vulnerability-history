require 'test_helper'
require 'selenium-webdriver'

class Homepage < ActiveSupport::TestCase
    test 'homepage' do
        begin
            driver = Selenium::WebDriver.for :chrome

            driver.navigate.to 'http://localhost:3000/'

            # refresh works fine
            url = driver.current_url
            driver.navigate.refresh
            assert_equal(url, driver.current_url)

            # title is what it should be
            assert_equal(driver.title, 'The Vulnerability History Project')


            # header appears how it should
            header = driver.find_element(class: 'top-bar')
            assert_not_nil(header)

            title = header.find_element(class: 'top-bar-left')
            icon = title.find_element(tag_name: 'img')
            assert_not_nil(icon)    # if i find out how to make sure the image is the logo i'll be sure to change this check
            title_text = title.find_element(tag_name: 'a').text
            assert_equal(title_text, 'The Vulnerability History Project')

            navbar = header.find_element(class: 'top-bar-right').find_element(tag_name: 'ul')
            links = navbar.find_element(tag_name: 'li')
            # links.each { |e| 
            #     print(e.text)
            # }


            # footer appears how it should
            footer = driver.find_element(class: 'footer')
            assert_not_nil(footer)


        ensure
            driver.quit
        end
    end
end