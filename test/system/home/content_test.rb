require "application_system_test_case"

class ContentTest < ApplicationSystemTestCase
  setup do
    Capybara.app_host = "https://alpha.vulnerabilityhistory.org"
    Capybara.run_server = false

    @start = '/'
    Rails.cache.clear
  end

  test 'look for "The Vulnerability History Project"' do
    visit @start
    gc = find('.grid-container').text

    assert gc.include? 'The Vulnerability History Project'
  end

  test 'look for "A museum of mistakes"' do
    visit @start
    gc = find('.grid-container').text

    assert gc.include? 'A museum of mistakes to help us engineer secure software.'
  end

  test 'a.buttons' do
    visit @start
    gc = find('.grid-container')
    buttons = gc.all('a')
    links = Array.new

    buttons.each { |button|
      links << button[:href]
    }

    links.each { |link|
      visit link
      assert_equal link, current_url
    }
  end
end
