require "application_system_test_case"

class ContentTest < ApplicationSystemTestCase
  setup do
    Capybara.app_host = "https://alpha.vulnerabilityhistory.org"
    Capybara.run_server = false

    @start = vulnerabilities_path
  end

  test 'vulnerabilities title and subtitle' do
    visit @start
    gc = find('.grid-container')
    title_wrapper = gc.all('.grid-x')[0]
    title_wrapper_cell = title_wrapper.find('.cell')
    assert_equal 'Vulnerabilities', title_wrapper_cell.find('.centered-title').text

    description_wrapper = gc.all('.grid-x')[1]
    description_wrapper_cell = description_wrapper.find('.cell')
    assert_equal(
      "These are the known vulnerabilities in our database. Every vulnerability known to " +
      "the VHP project is reported here, regardless of what the state of its curation is.\n" +
      "Each vulnerability is given upvotes by our curators. Upvotes are an entirely " +
      "subjective measure of how interesting the story each curator finds the vulnerability. " +
      "Everyone is encouraged to contribute upvotes to vulnerabilities!",
      description_wrapper_cell.text
    )

    # TODO Tabs are not being used anymore
    # tabs_wrapper = gc.all('.grid-x')[2]
    # tabs_wrapper_cell = tabs_wrapper.find('.cell')
    # tabs_ul = tabs_wrapper_cell.find('ul')
    # tabs = tabs_ul.all('.tabs-title')
    # assert_equal 'is-active', tabs[0][:class][/is-active/]
    # tabs.each do |tab|
    #   tab.click
    #   assert_equal 'is-active', tab[:class][/is-active/]
    # end
  end
end
