require "application_system_test_case"

class NavbarTest < ApplicationSystemTestCase
  setup do
    Capybara.app_host = "https://alpha.vulnerabilityhistory.org"
    Capybara.run_server = false

    @commits = '/commits'
    Rails.cache.clear
  end

  test'check for "Commits" title' do
    visit @commits
    gc = find('.grid-container')

    assert gc.text.include? 'Commits'
  end

  test 'commits table shows 10 results' do
    visit @commits
    table_body = find('tbody')

    assert_equal 10, table_body.all('tr').length
  end

  test 'individual commit' do
    visit @commits
    commit_hash = find('tbody').all('tr')[0].all('td')[0].text
    visit current_url << '/' << commit_hash

    gc = find('.grid-container')
    assert gc.text.include? commit_hash
  end
end