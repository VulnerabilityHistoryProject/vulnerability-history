require "application_system_test_case"

class ContentTest < ApplicationSystemTestCase
  setup do
    Capybara.app_host = "https://alpha.vulnerabilityhistory.org"
    Capybara.run_server = false

    @start = '/articles'
    Rails.cache.clear
  end

  test 'look for title' do
    visit @start
    gc = find('.grid-container')

    assert gc.text.include? 'Articles'
  end

  test 'article buttons' do
    visit @start
    gc = find('.grid-container')
    buttons = gc.all('a')
    links = Array.new

    buttons.each { |button|
      links << button[:href]
    }

    links.each { |link|
      visit link
      assert_equal link, current_url
    }
  end
end

