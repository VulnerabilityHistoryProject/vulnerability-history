require "application_system_test_case"

class ContentTest < ApplicationSystemTestCase
  setup do
    Capybara.app_host = "https://alpha.vulnerabilityhistory.org"
    Capybara.run_server = false

    @articles = '/articles'
    Rails.cache.clear
  end

  test 'check for "Articles" title' do
    visit @articles
    gc = find('.grid-container')

    assert gc.text.include? 'Articles'
  end

  test 'article buttons' do
    visit @articles
    gc = find('.grid-container')
    buttons = gc.all('a')
    links = Array.new

    buttons.each { |button|
      links << button[:href]
    }

    links.each { |link|
      visit link
      assert_equal link, current_url
    }
  end

  test 'article' do
    visit @articles << '/reverting'
    gc = find('.grid-container')

    assert gc.text.include? "Let's Just Undo That"
  end
end

