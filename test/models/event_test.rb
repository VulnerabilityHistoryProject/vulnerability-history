require 'test_helper'

class EventTest < ActiveSupport::TestCase

  test 'fixtures are loaded' do
    assert_equal 2, Event.count
  end

  test 'event details can be pulled' do
    e = events(:fix1_event)
    assert_equal 'Fix: Strip CRs from *.in files to allow building from webkit.org',
                 e.detail.title
    assert e.description.starts_with? 'R=darin'
    assert_equal 'fix', e.type
    assert_equal commits(:fix1).date_created, e.date
  end

  test 'event details can pull from notes' do
    e = events(:cve_2011_3092_bounty)
    assert_equal 1000.0, e.title
    assert_equal vulnerabilities(:cve_2011_3092).description, e.description
    assert_equal vulnerabilities(:cve_2011_3092).notes['bounty_announced'], e.date
    assert_equal "vulnerability", e.type
  end


end
