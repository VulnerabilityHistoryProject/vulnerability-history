require 'test_helper'

class TagTest < ActiveSupport::TestCase
  test 'overlaps' do

    #call overlaps method with set of shortnames that returns a set of tags
    @tags = Tag.overlaps(['cooks', 'owners', 'refactors', 'reverts'])
    #binding.irb

    #validate sql statement used to generate resullts
    

    expected_results = "[{\"cve\":\"CVE-2011-5904\",\"nickname\":\"Another Test CVE\",\"upvotes\":1,\"project_id\":298486374,\"description\":\"This is just another description. Maybe you'll see all of it, maybe you'll see some of it. I don't know. But, hopefully it'll let you see whatever it is you need that requires fixing. That's why we do it.\"},{\"cve\":\"CVE-2011-3093\",\"nickname\":\"Bad VCC/Fix\",\"upvotes\":2,\"project_id\":980190962,\"description\":\"This is some test data for the description. If the short_desc argument is working correctly, you shouldn't see this part of the description. Here's hoping!\"},{\"cve\":\"CVE-2016-1676\",\"nickname\":\"\",\"upvotes\":3,\"project_id\":980190962,\"description\":\"Google Chrome ~before 28.0.1500.71 allows remote attackers to cause a denial of service (out-of-bounds read) via vectors related to the handling of text.\"},{\"cve\":\"CVE-2013-2878\",\"nickname\":\"\",\"upvotes\":4,\"project_id\":980190962,\"description\":\"Google Chrome ~before 28.0.1500.71 allows remote attackers to cause a denial of service (out-of-bounds read) via vectors related to the handling of text.\"}]"
    assert_equal expected_results, @tags.to_json, 'SQL statement is not correct'
  end
end
