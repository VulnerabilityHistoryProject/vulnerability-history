require 'test_helper'

class TagTest < ActiveSupport::TestCase
  test 'overlaps' do
    #call overlaps method with set of shortnames that returns a set of tags
    overlapsResults = Tag.overlaps(['cooks', 'owners', 'refactors', 'reverts'], 5, 0)
    overlapsCVEResults = overlapsResults.map { |tag| tag['cve']}

    #validate sql statement used to generate results
    expected_results = %w(
      CVE-2013-2878
      CVE-2016-1676
      CVE-2011-3093
      CVE-2011-5904
    )
    assert_equal expected_results, overlapsCVEResults, 'SQL statement is not correct'
  end
end
