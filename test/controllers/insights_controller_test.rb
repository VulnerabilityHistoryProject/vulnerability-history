require 'test_helper'

class InsightsControllerTest < ActionDispatch::IntegrationTest

    test 'Checks basic route functionality' do
        assert_generates '/insights/tag-trends', controller: 'insights', action: 'tag_trends'
        assert_routing '/insights/tag-trends', controller: 'insights', action: 'tag_trends'
        assert_recognizes({controller: 'insights', action: 'tag_trends'}, 'insights/tag-trends')
    end

    test 'Checks tag trends api functionality' do
        assert_routing 'api/insights/tag-trends' , controller: 'insights', action: 'tag_trends_api'
        assert_recognizes({controller: 'insights', action: 'tag_trends_api'}, 'api/insights/tag-trends')
    end

    test 'Checks bad input to tag trends api' do
        get api_insights_tag_trends_url(family: ["invalid", "tags"])
        assert_response :bad_request
        assert_equal "Error: Invalid number of families or invalid families", @response.body
    end
end