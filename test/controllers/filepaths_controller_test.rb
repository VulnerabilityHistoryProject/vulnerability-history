require 'test_helper'

class FilepathsControllerTest < ActionDispatch::IntegrationTest
  # Andy deleted the auto-generated tests. Go look into Git history get them
  # back when we decide to write these tests.
  test 'Checks basic route functionality' do
    assert_generates '/filepaths', controller: 'filepaths', action: 'index'
    assert_routing '/filepaths', controller: 'filepaths', action: 'index'
    assert_recognizes({controller: 'filepaths', action: 'index'}, 'filepaths')
  end

  test 'Checks show functionality' do
    fp = filepaths(:'chrome/common/gfx/url_elider.cc').filepath
    assert_generates '/filepaths/' + fp, controller: 'filepaths', action: 'show', path: fp
    assert_routing '/filepaths/' + fp, controller: 'filepaths', action: 'show', path: fp
    assert_recognizes({controller: 'filepaths', action: 'show', path: fp}, "/filepaths/" + fp)
  end

  test 'ID redirection' do
    get '/filepaths/1'
    assert_redirected_to '/filepaths/chrome/common/gfx/url_elider.cc'
  end

  test 'Bad ID redirects' do
    get '/filepaths/12345'
    assert_redirected_to "/filepaths"
  end

  test 'Bad filepath redirects' do
    get '/filepaths/some/file/that/does/not/exist.extension'
    assert_redirected_to "/filepaths"
  end
end
