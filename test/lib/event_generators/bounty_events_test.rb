require 'test_helper'
require 'event_generators/bounty_events'
require 'writing'

class BountyEventsTest < ActiveSupport::TestCase

  test 'bounty events created for all vulns' do
    BountyEvents.new.generate
    expected = [
      "Bounty awarded for CVE-2011-3092"
    ]
    actual = Event.where(detail_type: 'Vulnerability').
                   where("title LIKE '%Bounty awarded%'").
                   map { |e| e.title }.sort
    assert_equal expected, actual
  end

end
