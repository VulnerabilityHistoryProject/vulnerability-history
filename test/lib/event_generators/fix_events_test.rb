require 'test_helper'
require 'event_generators/fix_events'

class FixEventsTest < ActiveSupport::TestCase

  test 'commit events created for all vulns' do
    event_count = Event.count
    FixEvents.new.generate
    expected = [
      # dup because we already had one in fixtures
      "Fix: Strip CRs from *.in files to allow building from webkit.org",
      "Fix: Strip CRs from *.in files to allow building from webkit.org",
      "Fix: Strip CRs from *.in files to allow building from webkit.org"
    ]
    actual = Event.where(detail_type: 'Fix').
                   map { |e| e.title }.sort
    assert_equal expected, actual
  end

end
