require 'test_helper'
require 'event_generators/fix_events'
require 'writing'

class FixEventsTest < ActiveSupport::TestCase

  setup do
    @silent_logger = TimingLogger.new(StringIO.new, '')
  end

  test 'fix events created for all vulns' do
    p = projects(:one)
    FixEvents.new(p, @silent_logger).generate
    actual = Event.where(title: "Fix for CVE-2011-3092: Strip CRs from *.in files to allow building from webkit.org").
                   count
    assert_equal 1, actual
  end

end
