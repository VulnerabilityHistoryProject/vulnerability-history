require 'test_helper'
require 'taggers/lifetime_tagger'

class LifetimeTagTest < ActiveSupport::TestCase

  test 'lifetime tag properly applied' do
    t = LifetimeTagger.new(projects(:one))
    t.create_tags
    t.apply_tags
    tag = Tag.find_by(shortname: 'lifetime-3mo')
    assert_includes tag.vulnerabilities.pluck(:cve), 'CVE-2011-3092'
  end

end
