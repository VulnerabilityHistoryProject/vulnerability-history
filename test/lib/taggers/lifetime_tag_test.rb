require 'test_helper'
require 'taggers/lifetime_tagger'

class LifetimeTagTest < ActiveSupport::TestCase

  test 'unit test tags created' do
    t = LifetimeTagger.new(projects(:one))
    t.create_tags
    assert_equal(1, Tag.where(shortname: 'escaped').size)
    assert_equal(1, Tag.where(shortname: 'lacked').size)
    assert_equal(1, Tag.where(shortname: 'untested').size)
  end

  test 'escape tag applied' do
    t = UnitTestTagger.new(projects(:one))
    t.create_tags
    t.apply_tags
    tag = Tag.find_by(shortname: 'escaped')
    assert(tag)
    vt = VulnerabilityTag.find_by(tag_id: tag.id)
    assert(vt)
    assert(vt.note)
  end

end
