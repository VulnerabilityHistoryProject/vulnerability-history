require 'test_helper'
require 'writing'
require 'taggers/auto_discoverable_tagger'
require 'taggers/specification_tagger'
require 'taggers/sandbox_tagger'

class SysMdTaggersTest < ActiveSupport::TestCase

  test 'autodiscoverable tags' do
    t = AutoDiscoverableTagger.new(projects(:one))
    t.create_tags
    t.apply_tags
    tag = Tag.find_by(shortname: 'auto-disc')
    assert(tag)
    vt = VulnerabilityTag.find_by(tag_id: tag.id)
    assert(vt)
  end

  # test 'specification tags' do
  #   t = SpecificationTagger.new(projects(:one))
  #   t.create_tags
  #   t.apply_tags
  #   tag = Tag.find_by(shortname: 'specification')
  #   assert(tag)
  #   vt = VulnerabilityTag.find_by(tag_id: tag.id)
  #   assert(vt)
  # end
  #
  # test 'sandbox tags' do
  #   t = SandBoxTagger.new(projects(:one))
  #   t.create_tags
  #   t.apply_tags
  #   tag = Tag.find_by(shortname: 'sandbox')
  #   assert(tag)
  #   vt = VulnerabilityTag.find_by(tag_id: tag.id)
  #   assert(vt)
  # end

end