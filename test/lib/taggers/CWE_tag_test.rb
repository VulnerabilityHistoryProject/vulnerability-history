require 'test_helper'
require 'taggers/cwe_tagger'

class CWETagTest < ActiveSupport::TestCase

  test 'cwe tags created' do
    t = CWETagger.new(projects(:one))
    t.create_tags
    assert_equal(1, Tag.where(shortname: 'cwe-110').size)
  end

  test 'cwe tags applied' do
    t = CWETagger.new(projects(:one))
    t.create_tags
    t.apply_tags
    tag = Tag.find_by(shortname: 'cwe-110')
    assert(tag)
    vt = VulnerabilityTag.find_by(tag_id: tag.id)
    assert(vt)
  end

#   test 'multi cwe tags applied' do
#     t = CWETagger.new(projects(:one))
#     t.create_tags
#     t.apply_tags
#  end
end