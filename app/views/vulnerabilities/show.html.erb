<p id="notice"><%= notice %></p>
<link href="https://fonts.googleapis.com/icon?family=Material+Icons"
      rel="stylesheet">

<div class="row">
  <div class="small-11 small-centered columns">
    <h1 class="centered-title"><%= @vulnerability.title %></h1>
  </div>
</div>

<header>
  <div class="row">
      <section id="horizontal-timeline"></section>
  </div>
</header>

<div class="row">
  <div class="small-10 small-offset-1 columns">
    <div class="data-toggles horizontal-center" id="toggle-block"></div>
  </div>
  <div class="small-1 columns horizontal-center" id="zoom-div">
    <span id="zoom-button" class="button material-icons">
      zoom_out
    </span>
    <input type="hidden" id="zoom-bool" name="zoom-bool" value=true>
  </div>
</div>

<div class="row">
  <div class="small-12 columns horizontal-center">
    <div id="legend" class="callout secondary">
        <h5 id="legend-body"></h5>
    </div>
  </div>
</div>

<div class="cd-container row callout">
  <p><%= markdown(@vulnerability.description) %></p>
  <ul class="accordian vertical menu" data-accordion-menu>
     <li>
       <a href="#">Details</a>
       <ul class="menu vertical nested">
         <li>
           <a href="#">Files patched</a>
           <ul class="menu vertical nested">
           <% @vulnerable_files.each do |vf| %>
             <li><%= link_to vf.filepath, vf %></li>
           <% end %>
           </ul>
         </li>
         <li>
           <a href="#">Fix Commits</a>
           <ul class="menu vertical nested">
           <% @vulnerability.fixes.each do |fix| %>
             <li><%= link_to fix.commit.title, fix.commit %></li>
           <% end %>
           </ul>
         </li>
         <li>
           <a href="#">Vulnerability Contributing Commits (VCCs)</a>
           <ul class="menu vertical nested">
             <% @vulnerability.vccs.each do |vcc| %>
               <li><%= link_to vcc.commit.title, vcc.commit %></li>
             <% end %>
           </ul>
         </li>
         <li>
           <a href="#">Researcher Notes</a>
           <ul class="menu vertical nested">
           <%= code_ray(@vulnerability.notes).html_safe %>
           </ul>
         </li>
       </ul>
     </li>
   </ul>
</div>

<section id="cd-timeline" class="cd-container">
  <% @events.each do |e| %>
      <div id="<%= e.type %>" data-id='<%= e.date %>'
           class="cd-timeline-block">
        <a id="<%= e.id %>"></a>
        <div class="cd-timeline-img"
             style="background: <%= e.style.color %>">
          <p id="timeline-icon"
             class="material-icons md-32 md-light">
             <%= e.style.icon %>
          </p>
        </div> <!-- cd-timeline-img -->
        <div class="cd-timeline-content">
          <h2 id="title"><%= e.title %></h2>
          <p id="description"><%= raw e.description %></p>
          <span class="cd-date" id="date">
            <% if e.date != nil %>
              <div id="isodate" style="display:none"><%= e.date %></div>
              <%= pretty_date(e.date) %>
            <% else %> <!-- if the time is not specified, use Time.current (this is a temporary fix) -->
              <%= Time.current %>
            <% end %>
          </span>
        </div>

      </div>
  <% end %>
</section>

<section id="tooltips">
</section>
<a href="#" class="scroll-to-top material-icons md-48 md-dark md-inactive">vertical_align_top</a>

  <%= javascript_include_tag "timeline/timeline" %>
