<p id="notice"><%= notice %></p>
<link href="https://fonts.googleapis.com/icon?family=Material+Icons"
      rel="stylesheet">

<div class="row">
  <div class="small-11 small-centered columns">
    <h1 class="centered-title"><%= @vulnerability.title %></h1>
  </div>
</div>

<header>
  <section id="horizontal-timeline">

  </section>
</header>

<div class="row">
  <div class="small-11 small-centered columns">
    <div class="data-toggles cd-container horizontal-center" id="toggle-block"></div>
    <div class="horizontal-center" id="zoom-div">
      <div id="zoom-button" class="button">zoom out</div>
    </div>
    <input type="hidden" id="zoom-bool" name="zoom-bool" value=true>
  </div>
</div>

<section id="details" class="cd-container">
  <div class="callout">
    <p><%= @vulnerability.description %></p>
    <ul class="accordian vertical menu" data-accordion-menu>
       <li>
         <a href="#">Details</a>
         <ul class="menu vertical nested">
           <li>
             <a href="#">Files patched</a>
             <ul class="menu vertical nested">
             <% @vulnerable_files.each do |vf| %>
               <li><%= link_to vf.filepath, vf %></li>
             <% end %>
             </ul>
           </li>
           <li>
             <a href="#">Fix Commits</a>
             <ul class="menu vertical nested">
             <% @vulnerability.fixes.each do |fix| %>
               <li><%= link_to fix.commit.title, fix.commit %></li>
             <% end %>
             </ul>
           </li>
           <li>
             <a href="#">Vulnerability Contributing Commits (VCCs)</a>
             <ul class="menu vertical nested">
               <% @vulnerability.vccs.each do |vcc| %>
                 <li><%= link_to vcc.commit.title, vcc.commit %></li>
               <% end %>
             </ul>
           </li>
           <li>
             <a href="#">Researcher Notes</a>
             <ul class="menu vertical nested">
               <% @vulnerability.notes.each do |k,v| %>
                 <li><h5><%= k %></h5> <%= v %> </li>
               <% end %>
             </ul>
           </li>
         </ul>
       </li>
     </ul>
  </div>
<section>

<section id="cd-timeline" class="cd-container">
  <% @events.each do |e| %>
      <div class="cd-timeline-block" id="<%= e.type %>" data-id='<%= e.date %>'>
        <a id="<%= e.id %>"></a>
        <div class="cd-timeline-img" style="background: red">
          <p class="material-icons md-32 md-light" id="timeline-icon"></p>
        </div> <!-- cd-timeline-img -->
        <div class="cd-timeline-content">
          <h2 id="title"><%= e.title %></h2>
          <p id="description"><%= e.description %></p>
          <a href="#" class="cd-read-more">Read more</a>
          <span class="cd-date" id="date">
            <% if e.date != nil %>
              <%= e.date %>
            <% else %> <!-- if the time is not specified, use Time.current (this is a temporary fix) -->
              <%= Time.current %>
            <% end %>
          </span>
        </div>

      </div>
  <% end %>
</section>

<section id="tooltips">
</section>
<a href="#" class="scroll-to-top material-icons md-48 md-dark md-inactive">vertical_align_top</a>

  <%= javascript_include_tag "timeline/timeline" %>
