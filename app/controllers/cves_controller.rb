class CvesController < ApplicationController

    def index
        redirect_to :controller => 'vulnerabilities', :action => 'index' 
        #redirect_to "/api/vulnerabilities/"
    end

    # GET /cves/CVE-2013-6665
    # GET /cves/CAN-2013-6665
    def show
        puts("here")
        puts(Vulnerability.find_by(cve: params[:name]))
        if(params[:name].index(/can/i) != nil)
            par = params[:name].sub!(/can/i, 'CVE')
            redirect_to :controller => 'vulnerabilities', :action => 'show', :id => Vulnerability.find_by(cve: par).id
        elsif Vulnerability.find_by(cve: params[:name]) != nil
            redirect_to :controller => 'vulnerabilities', :action => 'show', :id => Vulnerability.find_by(cve: params[:name]).id
        else
            #redirect_to :controller => 'vulnerabilities', :action => 'index'
            flash[:error] = "Error: Vulnerability not found"
            redirect_to controller: 'vulnerabilities'
        end
    end
end