require 'pathname'
class CurateController < ApplicationController

  def index
    @project_data = Project.select(:fullname, :subdomain, :bg_color, :vulnerabilities_description)
    @cve = Vulnerability.select(:cve)
  end

  def questions
    project = params[:project]
    # FIXME Temporary fix of Path Traversal for our next release, but we'll load from YML anyway
    questions_dir = Pathname.new('app/assets/javascripts/curationwizard/questions').realpath
    json_path = Pathname.new("#{questions_dir}/#{project}.json").realpath.to_s
    questions = if File.file?(json_path) && json_path.start_with?(questions_dir.to_s)
      File.read(json_path)
    else
      []
    end
    return render json: questions
  end

end
