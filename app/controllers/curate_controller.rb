
class CurateController < ApplicationController

  def index
    @project_data = Project.select(:fullname, :subdomain, :bg_color, :vulnerabilities_description)
    @cve = Vulnerability.select(:cve).order(cve: 'asc')
  end

  def questions
    project = params[:project]
    # FIXME Temporary fix of Path Traversal for our next release, but we'll load from YML anyway
    questions_dir = Pathname.new('app/assets/javascripts/curate/questions').realpath
    json_path_str = "#{questions_dir}/#{project}.json"
    if File.file?(json_path_str) && Pathname.new(json_path_str).realpath.to_s.start_with?(questions_dir.to_s)
      questions =  File.read(json_path_str)
    else
      questions = []
    end
    return render json: questions
  end

end