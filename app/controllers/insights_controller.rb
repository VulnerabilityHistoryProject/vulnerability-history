class InsightsController < ApplicationController
  before_action :permit_params

  # GET /api/insights/correlogram
  def correlogram
		if params_valid?
			render_json_for_api Tag.correlogram(params[:x], params[:y])
		else
			err_bad_params!
		end
  end

  private

		def err_bad_params!
			flash[:error] = 'Bad parameters provided to API call. See specification below.'
			redirect_to controller: 'about', action: 'api'
		end

		def params_valid?
			valid_tag_types = %w(
				project
				language
				cwe
				lesson
				lifetime
				discovered
				severity
				discussion
			)
			return valid_tag_types.include?(params[:x]) &&
						 valid_tag_types.include?(params[:y])
		end

    def permit_params
			begin
				params.required([:x, :y])
			rescue
				err_bad_params!
			end
    end
end
