$( document ).ready( function() {
  var offenders;
  $.when(
    $.ajax({
        url: "/api/filepaths?offenders=true",
        dataType: 'json'
    }).done(function(data) {
      offenders = data;
    }),
    $.ajax({
        type: "GET",
        dataType: "json",
        url: "/api/projects"
    }).done(function(data) {
      data.forEach(p =>
        $('.project-choice').append(`<option value=${p.id}>${p.name}</option>`)
      );
    })
  ).then(function() { // once both ajax calls are done
    $('#loading_map').remove();
    new OffenderMap(offenders).init();
  });
});
