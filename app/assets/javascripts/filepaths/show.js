$( document ).ready( function() {
    console.log($('#filepath_id').text());
    $.ajax({
        url: "/api/filepaths/"+ $('#filepath_id').text() +"/vulnerabilities",
        dataType: 'json',
        success: function(jsonData) {
            //link author's email by author_id
            /*jsonData.forEach(function(author, index) {
                jsonData[index]['email'] = authorEmails[author['author_id']];
            });*/

            $('#datatable').dataTable({
                destroy: true,
                data: jsonData,
                rowCallback: function(row, data, index){
                  $(row).on('click', function(){
                    var url = "/commits/" + data.id;
                    window.location.assign(url);
                  })
                },
                columnDefs: [
                  { "width": "10%", "targets": 0 }
                ],
                columns: [
                    { title: 'CVEs', data: 'cves', defaultContent: ''}
                ]
            });
        }
    });

    $('#datatable').on('mouseover', 'tbody tr', function() {
        $(this).css({
           'cursor': 'pointer',
            'color': 'blue'
        });
    })

    $('#datatable').on('mouseout', 'tbody tr', function() {
        $(this).css({
            'cursor': 'default',
            'color': 'inherit'
        });
    })
});
