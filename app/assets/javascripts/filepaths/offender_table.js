$( document ).ready( function() {
    $.ajax({
        url: "/api/filepaths?offenders=true",
        dataType: 'json',
        success: function(jsonData) {
            $('#datatable').dataTable({
                responsive: true,
                destroy: true,
                data: jsonData,
                order: [[2, "desc"]], /* Default sort */
                rowCallback: function(row, data, index){
                  $(row).on('click', function(){
                    window.location.assign("/filepaths/" + data.id);
                  })
                },
                columnDefs: [
                ],
                columns:  [
                  { title: 'File path', data: 'filepath', defaultContent: '', className: 'filepath', responsivePriority: 1},
                  { title: 'Fixes', data: 'num_fixes', defaultContent: '', responsivePriority: 2},
                  { title: 'CVEs', data: 'num_cves', defaultContent: '', responsivePriority: 3},
                  { title: 'CVEs', data: 'cves', defaultContent: '', responsivePriority: 4}
                ],
                initComplete: function () {
                    $('#loading').remove();
                  }
            });
        }
    });

    $('#datatable').on('mouseover', 'tbody tr', function() {
        $(this).css({
           'cursor': 'pointer',
            'color': 'blue'
        });
    })

    $('#datatable').on('mouseout', 'tbody tr', function() {
        $(this).css({
            'cursor': 'default',
            'color': 'inherit'
        });
    })
});
