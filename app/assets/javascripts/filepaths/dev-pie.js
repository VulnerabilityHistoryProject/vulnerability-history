$( document ).ready( function() {
  $.ajax({
    url: "/api/filepaths/" +
          window.location.pathname.split("/").pop() +
          "/contributors",
    dataType: 'json',
    success: function(data) {
      var width = 960,
          height = 700,
          radius = 0.95 * Math.min(width, height) / 2; // 95% for scale transform
      var svg = d3.select("#dev-pie")
                  .append("svg:svg")
                    .attr("width", width)
                    .attr("height", height)
                  .append("g")
                     .attr("transform", "translate(" + width / 2 + "," + height / 2 + ")");

      var color = d3.scaleSequential(d3.interpolateRgbBasis(['#C2D7B6','#3A6024','#C2D7B6']))
                    .domain([0,data.length])

      const pie = d3.pie()
                    .value(d => d.num_commits)
                    .sort(null);

      const arc = d3.arc()
                    .innerRadius(radius / 2)
                    .outerRadius(radius);

      var path = svg.selectAll('path')
                    .data(pie(data));

      path.enter()
          .append('a')
            .attr('href', d => '/developers/' + d.data.id)
            .attr('class', 'dev-pie-link')
          .append('path')
            .attr('d', arc)
            .attr('fill', (d, i) => color(i))
            .attr('stroke', '#fff')
            .attr('stroke-width', '5px')
          ;

      }
  });
});
