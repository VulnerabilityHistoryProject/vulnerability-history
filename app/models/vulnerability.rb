class Vulnerability < ApplicationRecord
  has_many :vccs, foreign_key: 'vulnerability_id'
  has_many :fixes, foreign_key: 'vulnerability_id'
  has_many :events, as: :detail
  has_many :vulnerability_tags, foreign_key: 'vulnerability_id'
  has_many :tags, through: :vulnerability_tags

  # Required for Event model
  def title
    cve
  end

  # Event: description is just the description field

  # Required for Event model
  def date
    announced
  end

  # Required for Event model
  def type
    "vulnerability"
  end

end
