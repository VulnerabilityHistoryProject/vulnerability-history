class Commit < ApplicationRecord
  has_many :commit_filepaths, foreign_key: 'commit_id'
  belongs_to :developer, foreign_key: 'author_id'
  has_many :filepaths, through: :commit_filepaths
  has_many :vccs, foreign_key: 'commit_id'
  has_many :fixes, foreign_key: 'commit_id'
  has_many :events, as: :detail

  # validates :commit_hash, :uniqueness => true

  # Required by Event model association
  def title
    message.each_line.to_a[0].strip
  end

  # Required by Event model association
  def description
    message.each_line.to_a[1..-1].join('\n')
  end

  # Required by Event model association
  def type
    "commit"
  end

  # Required by Event model association
  def date
    date_created
  end

end
