/*
This file is a small utility for formatting data coming from the VHP API
It's mostly just string concatentation with some minor logic.
So that we keep things consistent.
*/

export function vulnProject(data){
    return `<img class="${data.subdomain}-inline-logo"
                 title="${data.project_name}"/>`
}

export function vulnName(data){
  let str = data.cve;
  if(data.nickname != '' && data.nickname != null) {
    str = `${data.nickname} <br/> aka ${data.cve}`;
  }
  return str;
}

export function vulnLink(data, str) {
  return `<a class="dt_row" href="/vulnerabilities/${data.id}">${str}</a>`
}

//Simplifies the CWE name if it has a nickname in parentheses
export function friendlyCWE(name) {
  // "I do not want this ('I want this') not this" --> "I want this"
  // "Just a string" --> "Just a string"
  const match = name.match(/.*\(\'(.+)\'\).*/);
  if(match){
    return match[1]; //[0] is the full string, [1] is the actual match
  } else {
    return name;
  }
}
